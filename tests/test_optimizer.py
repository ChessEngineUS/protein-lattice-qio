"""\nUnit tests for optimizers.\n"""\n\nimport numpy as np\nimport pytest\nfrom src.optimizer import GreedyOptimizer, SimulatedAnnealingOptimizer, QuantumInspiredOptimizer\nfrom src.lattice import SquareLattice2D\nfrom src.energy import HPEnergyFunction\nfrom src.utils import set_seed\n\n\ndef test_greedy_optimizer():\n    """Test greedy optimizer produces valid conformation."""\n    set_seed(42)\n    \n    optimizer = GreedyOptimizer()\n    lattice = SquareLattice2D()\n    energy_fn = HPEnergyFunction()\n    sequence = "HPHPH"\n    \n    coords, energy, trajectory = optimizer.optimize(sequence, lattice, energy_fn)\n    \n    assert coords.shape == (len(sequence), 2)\n    assert lattice.is_valid_conformation(coords)\n    assert isinstance(energy, float)\n    assert len(trajectory) > 0\n\n\ndef test_simulated_annealing_optimizer():\n    """Test simulated annealing optimizer."""\n    set_seed(42)\n    \n    optimizer = SimulatedAnnealingOptimizer(\n        initial_temp=5.0,\n        final_temp=0.1,\n        steps=100,\n        device="cpu"\n    )\n    lattice = SquareLattice2D()\n    energy_fn = HPEnergyFunction()\n    sequence = "HPHPH"\n    \n    coords, energy, trajectory = optimizer.optimize(sequence, lattice, energy_fn)\n    \n    assert coords.shape == (len(sequence), 2)\n    assert lattice.is_valid_conformation(coords)\n    assert isinstance(energy, float)\n    assert len(trajectory) == 101  # initial + 100 steps\n\n\ndef test_quantum_inspired_optimizer():\n    """Test quantum-inspired optimizer."""\n    set_seed(42)\n    \n    optimizer = QuantumInspiredOptimizer(\n        initial_temp=5.0,\n        final_temp=0.1,\n        steps=100,\n        tunnel_rate=0.1,\n        device="cpu"\n    )\n    lattice = SquareLattice2D()\n    energy_fn = HPEnergyFunction()\n    sequence = "HPHPH"\n    \n    coords, energy, trajectory = optimizer.optimize(sequence, lattice, energy_fn)\n    \n    assert coords.shape == (len(sequence), 2)\n    assert lattice.is_valid_conformation(coords)\n    assert isinstance(energy, float)\n    assert len(trajectory) == 101\n\n\ndef test_optimizer_comparison():\n    """Test that different optimizers produce different results."""\n    set_seed(42)\n    \n    lattice = SquareLattice2D()\n    energy_fn = HPEnergyFunction()\n    sequence = "HPHPHPH"\n    \n    greedy = GreedyOptimizer()\n    sa = SimulatedAnnealingOptimizer(steps=50, device="cpu")\n    qi = QuantumInspiredOptimizer(steps=50, device="cpu")\n    \n    _, e_greedy, _ = greedy.optimize(sequence, lattice, energy_fn)\n    \n    set_seed(42)\n    _, e_sa, _ = sa.optimize(sequence, lattice, energy_fn)\n    \n    set_seed(42)\n    _, e_qi, _ = qi.optimize(sequence, lattice, energy_fn)\n    \n    # Energies should be valid\n    assert all(isinstance(e, float) for e in [e_greedy, e_sa, e_qi])\n